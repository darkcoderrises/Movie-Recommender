<div class="row" style="margin: 10px;">
    <div class="col-sm-8">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">{{booking.show.movie.title}}</h5>
                <h6 class="card-subtitle mb-2 text-muted">{{booking.show.screen.theater.name}}, {{booking.show.screen.theater.location}}</h6>
                <h6 class="card-subtitle mb-2">{{booking.show.show_time|date:"H:i | d-b-y"}}</h6>

                Invoice status : {{booking.invoice.status.name}}
                <br />
                Seats: <b>{{booking.seats.all.first.seat_type.name}}</b>
                {% for seat in booking.seats.all %}
                {{seat.row_id}}-{{seat.col_id}}
                {% endfor %}
                <br />
                Amount Paid: {{booking.invoice.total_price}}
            </div>
        </div>
    </div>
    <div class="col-sm-4" style="padding: 10px;">
        <center>
            <h4>Add your rating</h4>
            <div class="br-wrapper br-theme-fontawesome-stars" style="margin: 10px;">
                <div id="value-rating-{{booking.id}}"></div>
                <select id="rating-{{booking.id}}">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
            </div>
            <a id="submit-rating-{{booking.id}}" class="btn btn-outline-primary" role="button">Rate It</a>
        </center>
    </div>
</div>

<script type="text/javascript">
    $(function() {
        var rating = 0;
        $('#rating-{{booking.id}}')
            .barrating('show', {
                theme: 'fontawesome-stars',
                initialRating: '{{review.rating}}',
                onSelect: function(value, text, event) {
                    $('#value-rating-{{booking.id}}').text(value);
                    rating = value;
                },
            });

        $('#submit-rating-{{booking.id}}').on('click', function () {
            if (rating === 0) {
                return;
            }
            $.ajax({
                url: 'http://localhost:8000/rate/{{booking.show.movie.id}}',
                data: {
                    csrfmiddlewaretoken: '{{ csrf_token }}',
                    rating: rating,
                },
            });
        })
    });
</script>